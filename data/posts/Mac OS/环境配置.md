---
title: 环境配置
tags: [Mac]
categories: [电脑]
date: 2021-11-17 09:40:00
---

# M1 pro芯片启动Vue项目122441

「这是我参与11月更文挑战的第7天，活动详情查看：[2021最后一次更文挑战](https://juejin.cn/post/7023643374569816095/)」

## 安装Homebrew

homebrew是mac本很好的管理软件安装的工具，所以拿到mac本的第一时间我就安装了homebrew，由于网络原因很有可能安装失败，用下面的命令可以使用国内镜像，安装速度比较快。

```shell
/bin/zsh -c "$(curl -fsSL https://gitee.com/cunkai/HomebrewCN/raw/master/Homebrew.sh)"
复制代码	
```

![截屏2021-11-17 09.41.26](https://image.hansking.cn/uPic/202111/Gph7HW.png)

输入1后，按照提示一步一步进行安装就可以。

## 安装nvm

Nvm 是一个管理 Node 版本的工具，当项目多了以后，总会碰到需要切换 Node 环境的时候，所以推荐大家使用 Nvm 来安装 Node。通过下面的命令可以安装。

```shell
brew install nvm
复制代码
```

安装完成后，需要配置环境变量。通过下面的命令编辑.bash_profil配置文件。

```shell
vi ~/.bash_profile
复制代码
```

#### 注：[Mac M1安装 nvm 遇到的坑](https://www.jianshu.com/p/e945bb48593e)

> step1:
>
> 通过homebrew安装nvm
>
> 
>
> ```undefined
> > brew install nvm
> ```
>
> 注意：没有brew参照我的知乎文章：
>  [你新买的 MacBook air M1 所需的配置工作](https://links.jianshu.com/go?to=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F341455690)
>
> 但是到这一步并没有安装好，这时直接使用nvm指令会得到：
>
> 
>
> ```bash
> > nvm zsh: command not found: nvm
> ```
>
> 网上一些教程会告诉你要在 shell 文件（我是用的zsh，所以在~/.zshrc）中添加：
>
> > export NVM_DIR="![HOME/.nvm" [ -s "](https://math.jianshu.com/math?formula=HOME%2F.nvm%22%20%5B%20-s%20%22)NVM_DIR/nvm.sh" ] && . "![NVM_DIR/nvm.sh" # This loads nvm [ -s "](https://math.jianshu.com/math?formula=NVM_DIR%2Fnvm.sh%22%20%23%20This%20loads%20nvm%20%5B%20-s%20%22)NVM_DIR/bash_completion" ] && . "$NVM_DIR/bash_completion" # This loads nvm bash_completion
> >  ———————————————— 版权声明：本文为CSDN博主「曹天骄」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。 原文链接：[https://blog.csdn.net/solocao/article/details/83216819](https://links.jianshu.com/go?to=https%3A%2F%2Fblog.csdn.net%2Fsolocao%2Farticle%2Fdetails%2F83216819)
>
> 但添加后并没有用，还是显示`command not found:nvm`。原因是M1之后，homebrew不能放到 /usr/local/bin目录下了，要放到/opt目录下，所以以上指令要针对本地安装目录。
>
> step2：
>
> 
>
> ```undefined
> > brew info nvm
> ```
>
> 会根据你本机的配置情况得到相应的安装提示：
>
> 
>
> ```bash
> You should create NVM's working directory if it doesn't exist:
> 
>   mkdir ~/.nvm
> 
> Add the following to ~/.zshrc or your desired shell
> configuration file:
> 
>   export NVM_DIR="$HOME/.nvm"
>   [ -s "/opt/homebrew/opt/nvm/nvm.sh" ] && . "/opt/homebrew/opt/nvm/nvm.sh"  # This loads nvm
>   [ -s "/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm" ] && . "/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm"  # This loads nvm bash_completion
> ```
>
> 根据提示配置shell文件即可。
>
> 
>
> 作者：变身的大恶魔
> 链接：https://www.jianshu.com/p/e945bb48593e
> 来源：简书
> 著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。

亲测 M1 MacBook air 配置如下：

```bash
export NVM_DIR="$HOME/.nvm"
  [ -s "/opt/homebrew/opt/nvm/nvm.sh" ] && \. "/opt/homebrew/opt/nvm/nvm.sh"  # This loads nvm
  [ -s "/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm" ] && \. "/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm"  # This loads nvm bash_completion
```

将下面的配置脚本写入文件中。

```shell
export NVM_DIR="$([ -z "${XDG_CONFIG_HOME-}" ] && printf %s "${HOME}/.nvm" || printf %s "${XDG_CONFIG_HOME}/nvm")"
[ -s "$NVM_DIR/nvm.sh" ] && . "$NVM_DIR/nvm.sh" # This loads nvm
复制代码
```

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/042c7040d2f34e6698bdaf0b76e7af9b~tplv-k3u1fbpfcp-watermark.awebp?)写入后需要让配置生效，执行下面的命令。

```shell
source ~/.bash_profile
复制代码

```

> # Mac每次都要执行source ~/.bash_profile 后，配置的环境变量才生效
>
> **[# MacBook](https://codeantenna.com/tag/# MacBook)**
>
> ------
>
> 1. 问题：
>    1. 自己在 ~/.bash_profile 中配置环境变量, 可是每次重启终端后配置的不生效.需要重新执行 : $source ~/.bash_profile后，才会生效。
> 2. 原因：
>    1. 自己是在bash中配置的环境变量，而当前系统是使用的是shell
>    2. 查看当前使用的shell：
>       1. 终端输入：echo $SHELL
>       2. 输出是/bin/zsh，说明使用的是zsh
> 3. 解决办法：
>    1. 在.zshrc文件加中添加source ~/.bash_profile,方法如下
>       1. 进入主目录   cd ~
>       2. 显示隐藏文件，找到.zshrc文件夹 ls -a（如果没有可以只直接创建）
>       3. 编辑文件  vi .zshrc
>       4. 按i进入编辑模式，加入source ~/.bash_profile后，esc，再输入：wq保存退出

## 安装Node

接下来通过nvm安装Node，适配M1 pro芯片的node版本是v15。

```shell
nvm i v15
复制代码
```

该命令运行完后，会执行很久，编译 node ，大家耐心等就好了，大概需要 5-10 分钟，就会提示安装成功。再提醒一句，报任何错误，首先先检查是不是网络问题，例如 443 、 connect timeout 等。

## 安装结束

至此，git+homebrew+Node+npm的搭建已经完成了。接下来就可以在本地执行`npm install`和`npm run ...`命令来启动前端Vue项目，正常访问了。

> npm包安装失败：可以通过修改国内镜像安装所需依赖。执行下面代码成功后，可以执行`npm install`下载依赖正常启动项目，亲测有效。

```shell
npm config set registry https://registry.npm.taobao.org
npm info underscore
```

## git 代理配置

1. 查看代理信息

   ```bash
   # 查询动态代理
   git config --global http.proxy
   git config --global https.proxy
   ```

2. 设置代理

   ```bash
   # 设置代理
   git config --global https.proxy http://127.0.0.1:7890
   git config --global http.proxy http://127.0.0.1:7890
   
   # 取消代理
   git config --global --unset http.proxy
   git config --global --unset https.proxy
   ```




## npm、yarn源替换

```bash
npm config get registry  // 查看npm当前镜像源

npm config set registry https://registry.npm.taobao.org/  // 设置npm镜像源为淘宝镜像

yarn config get registry  // 查看yarn当前镜像源

yarn config set registry https://registry.npm.taobao.org/  // 设置yarn镜像源为淘宝镜像
```

- **镜像源地址部分如下：**

```text
npm --- https://registry.npmjs.org/

cnpm --- https://r.cnpmjs.org/

taobao --- https://registry.npm.taobao.org/

nj --- https://registry.nodejitsu.com/

rednpm --- https://registry.mirror.cqupt.edu.cn/

npmMirror --- https://skimdb.npmjs.com/registry/

deunpm --- http://registry.enpmjs.org/
```